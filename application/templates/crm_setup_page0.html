<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Main Layout Component</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
     <!-- Add Plotly CDN -->
     <script src='https://cdn.plot.ly/plotly-3.0.0.min.js'></script>
     <!--script src = "components.js"></script-->
     <!--script src= "app_components.js"></script-->

     <script src="{{ url_for('static', filename='components.js') }}"></script>
     <script src="{{ url_for('static', filename='app_components.js') }}"></script>
     <script src="{{ url_for('static', filename='support.js') }}"></script>
     <script src="{{ url_for('static', filename='locs_chart_support.js') }}"></script>
     
     <link href ="{{ url_for('static', filename='styles.css') }}" rel="stylesheet">

 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

</head>

<script>
class CRMSetupElement extends HTMLElement {
    constructor() {
        super();
    }

    connectedCallback() {
        this.innerHTML = this.getTemplate();
        this.initializeChart();

      
    }

    getTemplate() {
        return `
            <div id='modelling-page' class='page'>
                <div class="container-fluid chart-container">
                    <div id="chart-grid" style="height: 500px;"></div>
                </div>
                <h5>Well selection</h5>
                <div id='lasso-selected-indicator' style="line-height: 60px; vertical-align: middle;" class="hidden blue-indicator">Lasso selection active</div>
                <div id='all-selected-indicator' style="line-height: 60px; vertical-align: middle;" class="white-indicator">Applied filters in chart</div>
                <p></p>
                <h5>Apply distance filter</h5>
                <div>
                    <input id='model-distance' type="number" step="250" value='1750' name="quantity" class='form-control form-control-sm' min="500" max="15000">
                    <p></p>
                    <div>
                        <label>Generate simulations table</label><br>
                        <button id='extract-pairs-button' class='btn btn-primary'>Apply</button>
                    </div>
                </div>
                <p></p>
                <table-component id='simulations-table'></table-component>
                <p></p>
                <h5>Simulation name</h5>
                <input id='model-name' class="form-control form-control-sm" type="text" value="TestModel1">
                <p></p>
                <div>
                    <hr>
                    Export only? <input id='export-only' type="checkbox" checked>
                    <button id='history-match-save-and-run' style='margin:5px' class="btn btn-success">Run</button>
                </div>
            </div>
        `;
    }

    initializeChart() {
        const subplots = [
            {x: [1, 2, 3], y: [2, 6, 3]},
            {x: [1, 2, 3], y: [5, 2, 7]},
            {x: [1, 2, 3], y: [3, 4, 1]},
            {x: [1, 2, 3], y: [4, 1, 5]}
        ];

        const data = subplots.map((trace, idx) => ({
            ...trace,
            type: 'scatter',
            xaxis: `x${idx + 1}`,
            yaxis: `y${idx + 1}`
        }));

        const layout = {
            grid: {rows: 2, columns: 2, pattern: 'independent'},
            autosize: true,
            margin: {l: 40, r: 40, t: 20, b: 30},
            xaxis: {matches: 'x'},
            xaxis2: {matches: 'x'},
            xaxis3: {matches: 'x'},
            xaxis4: {matches: 'x'}
        };

        Plotly.newPlot('chart-grid', data, layout, {responsive: true});
    }
}

customElements.define('crm-setup-element', CRMSetupElement);


</script>



<body>
    <script>function Id(id){return document.getElementById(id)}</script>


<crm-setup-element></crm-setup-element>

                
<div id='modelling-page' class='page'>

    <div class="container-fluid">

        <div class="row">
            <div class="col-6 chart-container" id="crm-workstep-chart1" >
            </div>
            <div class="col-6 chart-container" id="crm-workstep-chart2" >
          
            </div>
        </div>
        <hr>
        <div class="row">
            <div class="col-6 chart-container" id="crm-workstep-chart3" >
          
            </div>
            <div class="col-6 chart-container" id="crm-workstep-chart3" >
            </div>
        </div>
    </div>

    <h5> Well selection </h5>
    <div id='lasso-selected-indicator' style="line-height:  60px; vertical-align: middle;"
        class="hidden blue-indicator">
        Lasso selection active
    </div>

    <div id='all-selected-indicator' style="line-height:  60px; vertical-align: middle;" class="white-indicator">
        Applied filters in chart
    </div>

    <p></p>
    <h5> Apply distance filter</h5>
    <div>
        <input id='model-distance' type="number" id="quantity" step="250" value='1750' name="quantity"
            class='form-control form-control-sm' min="500" max="15000">
        <p></p>
        <div>
            <label>Generate simulations table</label><br>
            <button id='extract-pairs-button' class='btn btn-primary'>Apply </button>
        </div>
            
            <!-- div>
                <table id='simulations-table' style='font-size:0.8em' class="table">
                <thead><tr><th>Producer</th><th>Injectors</th></tr></thead>
                <tbody></tbody>
                </table>                
            </div -->   
            
    </div>
    <p></p>    
    <table-component id='simulations-table'></table-component>
    <p></p>
    <h5> Training period </h5>
    <div>
        <input type='checkbox' class='hidden' id="injector-producer-distance-checkbox">
        <div>Start<input value='2016-05-01' id='model-date1' class='btn  date-entry' type="date"></div>
        <div>End<input value='2024-09-01' id='model-date2' class='btn  date-entry' type="date"></div>
        <div><button class='btn btn-primary' id="apply-dates-button">Apply </button> </div>
    </div>


    <div class="container-fluid">
        <div class="row">
            <div class='col-6'>
                <chart-placeholder-component id="chart1"
                    layout='{ "showlegend": true, "showgrid": true, "height":"400", "margin": {"l":"50", "r":"40","t":"30","b":"30"}  }'></chart-placeholder-component>
            </div>
            <div class='col-6'>
                <chart-placeholder-component id="chart2"
                    layout='{ "showlegend": true,"showgrid": true,  "height":"400", "margin": {"l":"50", "r":"40","t":"30","b":"30"}  }'></chart-placeholder-component>
            </div>
        </div>


        <div class="row">
            <div class='col-6'>
                <chart-placeholder-component id="chart3"
                    layout='{ "showlegend": true, "showgrid": true, "height":"400", "margin": {"l":"50", "r":"40","t":"30","b":"30"}  }'></chart-placeholder-component>
            </div>
            <div class='col-6'>
                <chart-placeholder-component id="chart4"
                    layout='{ "showlegend": true,"showgrid": true, "height":"400", "margin": {"l":"50", "r":"40","t":"30","b":"30"}  }'></chart-placeholder-component>
            </div>
        </div>

    </div>
    <p></p>
    <h5> Simulation name </h5>
    <input id='model-name' class="form-control form-control-sm" type="text" value="TestModel1">
    <p></p>
    <h5>Model type:</h5>
    <select id='model-type' name="balance" class="form-select" onchange="function s()
                    {  
                                                        
                        let model = document.getElementById('model-type').value
                        let disabled = (model=='crm_tank') || (model=='crmip')
                        console.log('here, model = ', model,' disabled ', disabled )  
                                                                         
                        if( disabled==true)                                   
                        document.getElementById('model-balance-placeholder').classList.add('hidden')
                        else
                        document.getElementById('model-balance-placeholder').classList.remove('hidden')
                                                           
                    }; 
                    s()">
        
        <option value="crm_tank">CRMT</option>
        <option value="crm_p">CRMP</option>
        <option value="crmip">CRMIP</option>
        <option value="crmp_constrained">CRMP Constrained</option>
        <option selected value="crmid_constrained">CRMID Constrained</option>
        

    </select>
        <div id='model-balance-placeholder'><label class='mt-3'>Balanced </label>
            <select class='form-control form-control-sm' name="balance" id='model-balance'>
                <option value="none">No</option>
                <option selected value="quick">Quick</option>
                <option value="full">Full</option>
            </select>
        </div>
    <p></p>
    <h5>Advanced parameters</h5>
    <details>
        <p></p>
        <div class='row'>
            <div class='col-3 text-end'><b>Parameter</b></div>
            <div class='col-3 text-center'>Initial</div>
            <div class='col-3 text-center'>Min</div>
            <div class='col-3 text-center'>Max</div>
            <hr>
        </div>

        <div class='row'>
            <div class='col-3 text-end'><b>Tau</b></div>
            <div class='col-3'><input class='form-control form-control-sm tau-initial' id=  'tau-initial' type="number" min="0.1" max="100" value="1" decimals="1" step="1"></div>
            <div class='col-3'><input class='form-control form-control-sm tau-min'     id = 'tau-min' type="number"     min="0.1" max="100" value="0.5" decimals="1" step="1"></div>
            <div class='col-3'><input class='form-control form-control-sm tau-max'     id = 'tau-max' type="number"     min="0.2" max="100" value="50"  decimals="1" step="1"></div>
        </div>

        <div class='row'>
            <div class='col-3 text-end'><b>Taup</b></div>
            <div class='col-3'><input class='form-control form-control-sm taup-initial' id='taup-initial' type="number" min="0.1" max="100" value="1" decimals="1" step="1"></div>
            <div class='col-3'><input class='form-control form-control-sm taup-min' id='taup-min' type="number" min="0.1" max="100" value="0.5"   decimals="1" step="1"></div>
            <div class='col-3'><input class='form-control form-control-sm taup-max' id='taup-max'  type="number" min="0.2" max="100" value="50" decimals="1" step="1"></div>
        </div>

        <div class='row'>
            <div class='col-3 text-end'><b>Lambda</b></div>
            <div class='col-3'><input class='form-control form-control-sm lambda-initial' id = 'lambda-initial' type="number" min="0.1" max="1.0" value="0.1"
                    decimals="1" step="0.1">
            </div>

            <div class='col-3'><input class='form-control form-control-sm lambda-min' id = 'lambda-min' type="number" min="0.0" max="2" value="0.0"
                    decimals="1" step="0.1"></div>
            <div class='col-3'><input class='form-control form-control-sm lambda-max' id = 'lambda-max' type="number" min="0.0" max="2.0" value="1.0"
                    decimals="1" step="0.1"></div>
        </div>

        <div class='row'>
            <div class='col-3 text-end'><b>Primary coefficient</b></div>
            <div class='col-3'><input class='form-control form-control-sm primary-initial' id='primary-initial' type="number" min="0.1" max="1" value="1.0"
                    decimals="1" step="0.1"></div>
            <div class='col-3'><input class='form-control form-control-sm primary-min' id='primary-min' type="number" min="0.0" max="2" value="0"
                    decimals="1" step="0.1"></div>
            <div class='col-3'><input class='form-control form-control-sm primary-max'  id='primary-max' type="number" min="0.0" max="2.0" value="1.0"
                    decimals="1" step="0.1"></div>
        </div>

        <div class='row'>
            <div class='col-3 text-end'><b>Productivity index</b></div>
            <div class='col-3'><input class='form-control form-control-sm productivity-initial' id='productivity-initial' type="number" min="0.1" max="1" value="0.0"
                    decimals="1" step="0.1"></div>
            <div class='col-3'><input class='form-control form-control-sm productivity-min' id='productivity-min' type="number" min="0.0" max="2" value="0"
                    decimals="1" step="0.1"></div>
            <div class='col-3'><input class='form-control form-control-sm productivity-max' id='productivity-max' type="number" min="0.0" max="2.0" value="1.0"
                    decimals="1" step="0.1"></div>
        </div>

        <div class='hidden row'>
            <div class='col-3 text-end'><b>Regularization</b></div>
            <div class='col-3'>
                <input class='form-control form-control-sm regularization' id='regularization' type="number" min="0.0" max="0.5" value="0.0" decimals="2"
                    step="0.01">
            </div>

        </div>





    </details>
    <div>
        <hr>
        </hr>
        Export only? <input id='export-only' type="checkbox" id="myCheck" checked> 
        <button id='history-match-save-and-run' style='margin:5px' class="btn btn-success"> Run</button>
    </div>
</div>


</body>
</html>

                
     
